{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// 'use strict';\n\n// Import\nimport axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43059810-21766dfeafea29ca9c24ae0e2';\n\nasync function servicePicture(picture = '', page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: picture,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.status);\n  }\n}\n\n// Export\nexport { servicePicture };\n","'use strict';\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"pictureCard\">\n          <a href=\"${largeImageURL}\" class=\"lightbox-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture-icon\">\n          </a>\n          <div class=\"picture-info\">\n            <div>\n              <span>Likes:</span>\n              <span class=\"likes\">${likes}</span>\n            </div>\n            <div>\n              <span>Views:</span>\n              <span class=\"views\">${views}</span>\n            </div>\n            <div>\n              <span>Comments:</span>\n              <span class=\"comments\">${comments}</span>\n            </div>\n            <div>\n              <span>Downloads:</span>\n              <span class=\"downloads\">${downloads}</span>\n            </div>\n          </div>\n        </li>`\n    )\n    .join('');\n}\n\n// Export\nexport { createMarkup };\n","'use strict';\n\n// Library Izitoast\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Library SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Import\nimport { servicePicture } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\n// Code\nconst searchForm = document.getElementById('search-form');\nconst list = document.getElementById('list');\nconst loadButton = document.getElementById('load-button');\nconst loader = document.querySelector('.loader');\nconst gallery = new SimpleLightbox('.pictureCard a', {\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nlet currentPage = 1;\nlet currentQuery = '';\n\n// EventListener\nsearchForm.addEventListener('submit', handleSubmit);\nloadButton.addEventListener('click', event => {\n  event.preventDefault();\n  handleLoadMore();\n});\n\nfunction clearMarkup() {\n  list.innerHTML = '';\n}\n\nloadButton.style.display = 'none';\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  const { picture } = event.currentTarget.elements;\n  currentQuery = picture.value;\n\n  // Show Loader\n  loader.style.display = 'block';\n\n  // Clear\n  clearMarkup();\n\n  try {\n    const data = await servicePicture(currentQuery, currentPage);\n\n    // Если в ответе приходит хотя бы одно изображение, рендерим их\n    if (data.hits.length > 0) {\n      list.innerHTML = createMarkup(data.hits);\n      toggleLoadButton(data.totalHits);\n      gallery.refresh();\n    } else {\n      // Если в ответе нет изображений, скрываем кнопку \"Load more\"\n      loadButton.style.display = 'none';\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n  } catch (error) {\n    console.error('Error:', error);\n    iziToast.error({\n      title: 'Error',\n      message:\n        'An error occurred while fetching images. Please try again later!',\n    });\n  } finally {\n    // Hide Loader\n    loader.style.display = 'none';\n    // Reset form\n    searchForm.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  currentPage += 1;\n  try {\n    const data = await servicePicture(currentQuery, currentPage);\n    if (data.hits.length > 0) {\n      list.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n      toggleLoadButton(data.totalHits);\n\n      // Slow scroll\n      const galleryCardHeight = document\n        .querySelector('.pictureCard')\n        .getBoundingClientRect().height;\n      window.scrollBy({\n        top: galleryCardHeight * 3,\n        behavior: 'smooth',\n      });\n\n      gallery.refresh();\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load!',\n      });\n    }\n\n    // The end check\n    if (currentPage * 15 >= data.totalHits) {\n      loadButton.style.display = 'none';\n      iziToast.info({\n        title: 'End of search results',\n        message:\n          \"We're sorry, but you're nearing the end of the search results.\",\n      });\n    }\n  } catch (error) {\n    console.error('Error:', error);\n    iziToast.error({\n      title: 'Error',\n      message:\n        'An error occurred while fetching more images. Please try again later!',\n    });\n  }\n}\n\nfunction toggleLoadButton(totalHits) {\n  if (currentPage * 15 < totalHits) {\n    loadButton.style.display = 'block';\n  } else {\n    loadButton.style.display = 'none';\n  }\n}\n"],"names":["BASE_URL","API_KEY","servicePicture","picture","page","axios","error","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","list","loadButton","loader","gallery","SimpleLightbox","currentPage","currentQuery","handleSubmit","event","handleLoadMore","clearMarkup","data","toggleLoadButton","iziToast","galleryCardHeight","totalHits"],"mappings":"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"}